%Енин Георгий, ВТ-12
\section{ЭЛЕМЕНТЫ ДИСКРЕТНОГО ПРОГРАММИРОВАНИЯ}
\subsection{Некоторые задачи, приводящие к требованию целочисленности. Постановка задач дискретного программирования }
Среди практически важных задач отыскания условного экстремума линейной функции особое место занимают задачи с требованием целочисленности всех или части переменных. Они получили название задач целочисленного (частично целочисленного) программирования. Исторически первой задачей целочисленного типа явилась, опубликованная венгерским математиком Е. Эгервари в 1932 году, задача о назначении персонала.
\par\textit{Задача о назначениях.} Пусть требуется выполнить $n$ видов различных работ и имеется $n$ исполнителей (машин или людей) для их выполнения. Каждый исполнитель может использоваться на любой работе. Производительности исполнителей на различных работах, вообще говоря, различны. Обозначим через $c_{ij}$ производительность $i$-го исполнителя на $j$-ой работе. Задача заключается в таком распределении исполнителей по работам, при котором суммарная производительность максимальна.
\parПостроим математическую модель этой задачи. Для описания каждого варианта распределения исполнителей по работам введем переменные $x_{ij}$, относительно которых условимся, что $x_{ij}=1$, если $i$-й исполнитель назначен на $j$-ю работу, и $x_{ij}=0$ — в противном случае. Выбор варианта назначения исполнителей на работы равносилен приданию переменным $x_{ij}$ значений 0 или 1. При этом должны выполняться условия\\
$$\sum_{j=1}^n x_{ij} = 1, \; i = 1,2,...,n,$$
которые означают, что каждый исполнитель назначается на работу, а также условия
$$\sum_{i=1}^n x_{ij} = 1, \; j = 1,2,...,n,$$
которые означают, что каждая работа обеспечивается исполнителем. Суммарная производительность при данном варианте назначений выразится суммой
$$\sum_{i=1}^n \sum_{j=1}^n c_{ij}x_{ij}$$
\parТаким образом, получаем следующую математическую модель задачи
$$z = \sum_{i=1}^n \sum_{j=1}^n c_{ij}x_{ij}\rightarrow \textrm{max}$$
$$\sum_{j=1}^n x_{ij} = 1, \; i = 1,2,...,n,\; \sum_{i=1}^n x_{ij} = 1, \; j = 1,2,...,n,$$
$$	x_{ij} = \begin{cases}
		1\\
		0
	\end{cases}\hspace{-1em},\;\; i = 1,2,...,n,\;\;j = 1,2,...,n.
$$
\parПоследние из условий носят название условий булевости переменных $x_{ij}$, а задачи математического программирования с такими условиями называются задачами с булевыми переменными. Отметим, что замена условий булевости условиями неотрицательности переменных превращает нашу задачу в обычную закрытую транспортную задачу, если ее сформулировать как задачу на минимум. Если эту задачу решить методом потенциалов, то полученное решение автоматически будет удовлетворять условию булевости. Таким образом, в задаче о назначениях условия булевости переменных можно заменить условиями их неотрицательности. Отметим, что возможен открытый вариант задачи о назначениях, в котором количество исполнителей и видов работ не совпадают. С помощью введения фиктивных исполнителей или фиктивных видов работ эта задача сводится к такой же закрытой задаче, в которой производительности фиктивных пунктов полагаются равными нулю. При решении задачи некоторые исполнители могут оказаться без работы или некоторые виды работ — без исполнителей. При этом по-прежнему условия булевости можно заменить условиями неотрицательности.
\primer{
	Фирма объявила набор работников на две появившиеся вакансии. Были поданы заявления от трех претендентов, готовых занять каждую из двух вакансий. Предварительные испытания определили, что производительности претендентов на работе по каждой из двух вакансий задаются матрицей
	$$
		\begin{pmatrix}
			4 & 7 & 1\\
			5 & 3 & 6
		\end{pmatrix}.
	$$
}
\parТребуется так заполнить вакансии имеющимися претендентами, чтобы суммарная производительность принятых работников была максимальной. Предполагается, что каждая вакансия заполняется лишь одним претендентом, а каждый претендент может занять не более одной вакансии.
\parДля составления математической модели задачи введем такие переменные $x_{ij}$, что $x_{ij}=1$, если $i$-й исполнитель назначен на $j$-ю работу, и $x_{ij}=0$ — в противном случае. Получаем следующую задачу на максимум
$$
\begin{cases}
   x_{11} + x_{12} + x_{13} = 1,\\
   x_{21} + x_{22} + x_{23} = 1;
\end{cases}
\begin{cases}
	x_{11} + x_{21} \leq 1,\\
	x_{12} + x_{22} \leq 1,\\
	x_{13} + x_{23} \leq 1;
\end{cases}
$$
$$	x_{ij} = \begin{cases}
		1\\
		0
	\end{cases}\hspace{-1em},\;\; i = 1,2,3,\;\; j = 1,2,3.
$$
\parПосле введения фиктивной вакансии мы получаем задачу, в которой условия бул	евости можно заменить условиями неотрицательности переменных. Задачу можно рассматривать как транспортную задачу на минимум целевой функции $z = -4x_{11} - 7x_{12} - x_{13} - 5x_{21} - x_{22} -6x_{23}\rightarrow \textrm{max}$, которую можно записать в виде следующей таблицы данных
$$
\begin{tabular}{|c|*{4}{c|}}
	\hline
	\parbox{1.5cm}{\hspace{1.5cm}}& & \parbox{2cm}{$$v_1$$} & \parbox{2cm}{$$v_2$$} & \parbox{2cm}{$$v_3$$}\\
	\hline
	& \raisebox{-1.5ex}[0cm][0cm]{\centering Запасы} & \multicolumn{3}{c|}{Потребности} \\
	\cline{3-5}
	 & & 1 & 1 & 1\\
	\hline
	$u_1$ & 1 & {\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{-4} & \\  & \; \\ \end{tabular}} &{\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{-7} & \\  & 1 \\ \end{tabular}} & {\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{-1} & \\  & 0 \\ \end{tabular}}\\
	\hline
	$u_2$ & 1 & {\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{-5} & \\  & 1 \\ \end{tabular}} &{\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{-1} & \\  & 0 \\ \end{tabular}} & {\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{-6} & \\  & 0 \\ \end{tabular}}\\
	\hline
	$u_3$ & 1 & {\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{0} & \\  & \; \\ \end{tabular}} &{\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{0} & \\  & \; \\ \end{tabular}} & {\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{0} & \\  & 1 \\ \end{tabular}}\\
	\hline
\end{tabular}
$$
\parНаходим первое опорное решение методом наименьшей стоимости. Запишем и решим систему уравнений для потенциалов.
$$
\begin{cases}
   u_1 + v_2 = -7,\\
   u_1 + v_3 = -1,\\
   u_2 + v_1 = -5,\\
   u_2 + v_3 = -6,\\
   u_3 + v_3 = 0.
\end{cases}
\raisebox{1.5em}{$
	\begin{cases}
		u_1 = 0,\hspace{3.7ex} v_1 = 0,\\
		u_2 = -5,\hspace{2ex} v_2 = -7,\\
		u_3 = 1,\hspace{3.7ex} v_3 = -1;
	\end{cases}$
}
$$
\parВычислим коэффициенты $\gamma_{ij}$ для свободных клеток. $\gamma_{11}=-4$, $\gamma_{22}=11$, $\gamma_{31}=-1$, $\gamma_{32}=6$. Составим цикл пересчета для клетки $x_{31}$ и произведем сдвиг по этому циклу на единицу. Получим следующую таблицу
$$
\begin{tabular}{|c|*{4}{c|}}
	\hline
	\parbox{1.5cm}{\hspace{1.5cm}}& & \parbox{2cm}{$$v_1$$} & \parbox{2cm}{$$v_2$$} & \parbox{2cm}{$$v_3$$}\\
	\hline
	& \raisebox{-1.5ex}[0cm][0cm]{\centering Запасы} & \multicolumn{3}{c|}{Потребности} \\
	\cline{3-5}
	 & & 1 & 1 & 1\\
	\hline
	$u_1$ & 1 & {\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{-4} & \\  & 0 \\ \end{tabular}} &{\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{-7} & \\  & 1 \\ \end{tabular}} & {\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{-1} & \\  & \; \\ \end{tabular}}\\
	\hline
	$u_2$ & 1 & {\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{-5} & \\  & 1 \\ \end{tabular}} &{\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{-1} & \\  & \; \\ \end{tabular}} & {\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{-6} & \\  & \; \\ \end{tabular}}\\
	\hline
	$u_3$ & 1 & {\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{0} & \\  & 0 \\ \end{tabular}} &{\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{0} & \\  & \; \\ \end{tabular}} & {\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{0} & \\  & 1 \\ \end{tabular}}\\
	\hline
\end{tabular}
$$
Снова составим и решим систему уравнений для потенциалов.
$$
\begin{cases}
   u_1 + v_1 = -4,\\
   u_1 + v_2 = -7,\\
   u_2 + v_1 = -5,\\
   u_3 + v_1 = 0,\\
   u_3 + v_3 = 0.
\end{cases}
\raisebox{1.5em}{$
	\begin{cases}
		u_1 = 0,\hspace{3.7ex} v_1 = -4,\\
		u_2 = -1,\hspace{2ex} v_2 = -7,\\
		u_3 = 4,\hspace{3.7ex} v_3 = -4;
	\end{cases}$
}
$$
Следовательно, $\gamma_{13}=1$, $\gamma_{22}=7$, $\gamma_{23}=-1$, $\gamma_{32}=3$. Составим цикл пересчета для клетки $x_{23}$ и произведем сдвиг по этому циклу. Получим таблицу
$$
\begin{tabular}{|c|*{4}{c|}}
	\cline{3-5}
	\multicolumn{2}{c|}{} & \parbox{2cm}{$$v_1$$} & \parbox{2cm}{$$v_2$$} & \parbox{2cm}{$$v_3$$}\\
	\cline{2-5}
	\multicolumn{1}{c|}{} & \raisebox{-1.5ex}[0cm][0cm]{\centering Запасы} & \multicolumn{3}{c|}{Потребности} \\
	\cline{3-5}
	\multicolumn{1}{c|}{} & & 1 & 1 & 1\\
	\hline
	\parbox{1.5cm}{\centering $u_1$} & 1 & {\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{-4} & \\  & 1 \\ \end{tabular}} &{\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{-7} & \\  & 0 \\ \end{tabular}} & {\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{-1} & \\  & \; \\ \end{tabular}}\\
	\hline
	$u_2$ & 1 & {\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{-5} & \\  & \; \\ \end{tabular}} &{\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{-1} & \\  & 1 \\ \end{tabular}} & {\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{-6} & \\  & \; \\ \end{tabular}}\\
	\hline
	$u_3$ & 1 & {\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{0} & \\  & 0 \\ \end{tabular}} &{\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{0} & \\  & \; \\ \end{tabular}} & {\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{0} & \\  & 1 \\ \end{tabular}}\\
	\hline
\end{tabular}
$$
$$
\begin{cases}
   u_1 + v_1 = -4,\\
   u_1 + v_2 = -7,\\
   u_2 + v_2 = -1,\\
   u_3 + v_1 = 0,\\
   u_3 + v_3 = 0.
\end{cases}
	\begin{cases}
		u_1 = 0,\hspace{2ex} v_1 = -4,\\
		u_2 = 6,\hspace{2ex} v_2 = -7,\\
		u_3 = 4,\hspace{2ex} v_3 = -4;
	\end{cases}
$$
$\gamma_{13}=3$, $\gamma_{21}=-7$, $\gamma_{23}=-8$, $\gamma_{32}=3$. Производим сдвиг по циклу пересчета для клетки $x_{21}$.
$$
\begin{tabular}{|c|*{4}{c|}}
	\cline{3-5}
	\multicolumn{2}{c|}{} & \parbox{2cm}{$$v_1$$} & \parbox{2cm}{$$v_2$$} & \parbox{2cm}{$$v_3$$}\\
	\cline{2-5}
	\multicolumn{1}{c|}{} & \raisebox{-1.5ex}[0cm][0cm]{\centering Запасы} & \multicolumn{3}{c|}{Потребности} \\
	\cline{3-5}
	\multicolumn{1}{c|}{} & & 1 & 1 & 1\\
	\hline
	\parbox{1.5cm}{\centering $u_1$} & 1 & {\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{-4} & \\  & 1 \\ \end{tabular}} &{\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{-7} & \\  & 0 \\ \end{tabular}} & {\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{-1} & \\  & \; \\ \end{tabular}}\\
	\hline
	$u_2$ & 1 & {\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{-5} & \\  & \; \\ \end{tabular}} &{\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{-1} & \\  & 1 \\ \end{tabular}} & {\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{-6} & \\  & \; \\ \end{tabular}}\\
	\hline
	$u_3$ & 1 & {\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{0} & \\  & 0 \\ \end{tabular}} &{\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{0} & \\  & \; \\ \end{tabular}} & {\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{0} & \\  & 1 \\ \end{tabular}}\\
	\hline
\end{tabular}
$$
$$
\begin{cases}
   u_1 + v_1 = -4,\\
   u_1 + v_2 = -7,\\
   u_2 + v_2 = -5,\\
   u_3 + v_1 = 0,\\
   u_3 + v_3 = 0.
\end{cases}
	\begin{cases}
		u_1 = 0,\hspace{3.7ex} v_1 = -4,\\
		u_2 = -1,\hspace{2ex} v_2 = -7,\\
		u_3 = 4,\hspace{3.7ex} v_3 = -4;
	\end{cases}
$$
$\gamma_{13}=3$, $\gamma_{22}=7$, $\gamma_{23}=-1$, $\gamma_{32}=3$. Преобразуем таблицу с помощью цикла пересчета для клетки $x_{23}$.
$$
\begin{tabular}{|c|*{4}{c|}}
	\cline{3-5}
	\multicolumn{2}{c|}{} & \parbox{2cm}{$$v_1$$} & \parbox{2cm}{$$v_2$$} & \parbox{2cm}{$$v_3$$}\\
	\cline{2-5}
	\multicolumn{1}{c|}{} & \raisebox{-1.5ex}[0cm][0cm]{\centering Запасы} & \multicolumn{3}{c|}{Потребности} \\
	\cline{3-5}
	\multicolumn{1}{c|}{} & & 1 & 1 & 1\\
	\hline
	\parbox{1.5cm}{\centering $u_1$} & 1 & {\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{-4} & \\  & 0 \\ \end{tabular}} &{\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{-7} & \\  & 1 \\ \end{tabular}} & {\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{-1} & \\  & \; \\ \end{tabular}}\\
	\hline
	$u_2$ & 1 & {\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{-5} & \\  & \; \\ \end{tabular}} &{\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{-1} & \\  & \; \\ \end{tabular}} & {\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{-6} & \\  & 1 \\ \end{tabular}}\\
	\hline
	$u_3$ & 1 & {\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{0} & \\  & 1 \\ \end{tabular}} &{\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{0} & \\  & \; \\ \end{tabular}} & {\begin{tabular}{lr} \hspace{-2ex}\framebox[1cm][c]{0} & \\  & 0 \\ \end{tabular}}\\
	\hline
\end{tabular}
$$
$$
\begin{cases}
   u_1 + v_1 = -4,\\
   u_1 + v_2 = -7,\\
   u_2 + v_2 = -6,\\
   u_3 + v_1 = 0,\\
   u_3 + v_3 = 0.
\end{cases}
	\begin{cases}
		u_1 = 0,\hspace{3.7ex} v_1 = -4,\\
		u_2 = -2,\hspace{2ex} v_2 = -7,\\
		u_3 = 4,\hspace{3.7ex} v_3 = -4;
	\end{cases}
$$
$\gamma_{13}=3$, $\gamma_{21}=1$, $\gamma_{22}=8$, $\gamma_{32}=3$. Получена последняя таблица, содержащая решение задачи. Второй претендент получает первую вакансию, третий — вторую, а первый остается безработным.
\parНе во всякой задаче с условиями целочисленности эти последние условия можно игнорировать. В большинстве случаев они играют очень существенную роль.
\par\textit{Задача о ранце.} Имеется вектор ограниченных ресурсов  $\vec b = \{b_1,b_2,...,b_m\}$, которые можно использовать для перевозки различных по своим характеристикам грузов. Каждый из этих n видов грузов имеет следующие свойства:
\begin{enumerate}
\item[1)] неделимость, т.е. для транспортировки груз с номером $j$ может выбираться в количестве кратном единице;
\item[2)] определена полезность (или стоимость) $c_j$ единицы груза;
\item[3)] известным является расход $i$-го ресурса для перевозки единицы $j$-го груза $a_{ij}, \;\;\; i=1,2,...,m,\;\;\; j=1,2,...,n$.
\end{enumerate}
\parТребуется определить такой набор груза различных видов, при котором общая полезность рейса максимальна. Под полезностью рейса понимается суммарная стоимость перевезенного за рейс груза.
\parПостроим математическую модель задачи. Пусть $x_j$ - количество выбранных для перевозки предметов $j$-го вида. Требованию неделимости соответствует условие
$$x_j \geq 0,\;\textrm{ — целые числа},\;\; j = 1,2,...,n.$$
\parСопоставляя расход ресурсов при транспортировке с их наличным количеством, получаем ограничения
$$\sum_{j=1}^n a_{ij}x_j \leq b_i \;\; i = 1,2,...,m.$$
\parОбщая полезность рейса определяется значением целевой функции
$$z = \sum_{j=1}^n c_jx_j.$$
\parЧастным случаем этой задачи является классическая задача о ранце, в которой переменные $x_j$ подчинены условию булевости. Смысл этих условий заключается в том, что любой из заданного набора предметов (грузов) может быть выбран для перевозки или нет, т.е. $x_j$ может принимать значения 0 или 1.
\parЧасто возникают и другие подобные задачи, которые можно сформулировать в виде следующей задачи на максимум
\begin{equation}
\begin{split}
	&z = \sum_{j=1}^n c_jx_j \rightarrow \textrm{max},\\
	&\sum_{j=1}^n a_{ij}x_j\;\{\leq\;=\;\geq\}b_i,\;\;\;i = 1,2,...,m,\\
	&x_j \geq 0,\;\;\; j = 1,2,...,n,\\
	&x_j \;\textrm{ — целые числа},\;\;\; j = 1,2,...,k.
\end{split}
\tag{P}
\end{equation}
\parЗадачу ($P$) при $k<n$ будем называть задачей частично целочисленного программирования. При $k=n$ сформулированная задача называется задачей целочисленного программирования. Более общими являются задачи дискретного или частично дискретного программирования. В этих задачах все или часть переменных принимают значения из заранее заданного дискретного множества. Ниже мы в основном будем рассматривать целочисленные задачи.
\parОсновные понятия обычного линейного программирования переносятся и на дискретный случай. Вектор $X = \{x_1,x_2,...,x_n\}$, удовлетворяющий системе ограничений задачи, называется допустимым решением (планом) задачи. Допустимое решение, доставляющее максимум целевой функции, называют оптимальным решением (планом). Процесс решения задачи дискретного программирования состоит в нахождении оптимального плана.
\parКазалось бы, естественный путь решения целочисленной задачи состоит в решении соответствующей обычной линейной задачи с последующим округлением компонент оптимального плана $X = \{x_1,x_2,...,x_n\}$ до ближайших целых чисел. На самом деле такой путь в большинстве случаев не только уводит от оптимума, но даже приводит иногда к недопустимому решению задачи.
\primer{
	Рассмотрим задачу целочисленного программирования с двумя переменными\begin{equation*}
	\begin{split}
		&z = x_1 + x_2 \rightarrow \textrm{max},\\
		&\begin{cases}
			x_1 + x_2 \leq 7,\\
			4x_1 - 5x_2 \leq 5,\\
			2x_1 + 11x_2 \leq 38;
		\end{cases}\\
		&x_1 \geq 0, \; x_2 \geq 0,\; x_1,\;x_2\;\textrm{ — целые числа}.
	\end{split}
\end{equation*}
}
\parОтбросим условия целочисленности и решим задачу графически. Экстремум достигается в точках $A \left(\frac{13}{3},\frac{8}{3}\right)$ и $B \left(\frac{40}{9},\frac{23}{9}\right)$ , а также в любой точке отрезка $AB$, и  равен 7. Округляя  значения  координат $A$, получим точку  , которая не принадлежит области поиска. Можно показать, что максимум достигается в точках $N(3,2)$ и $M(2,3)$ и равен 5.
\parРассмотренный пример показывает, что для задач дискретного программирования необходимо применять особые методы оптимизации.
\subsection{Методы отсечения. Первый алгоритм Гомори}
\parМетоды отсечения сводятся к решению некоторой последовательности специально построенных задач линейного программирования без условий целочисленности. Каждая последующая задача получается из предыдущей добавлением дополнительного линейного ограничения (неравенства), называемого сечением. Если обозначить через З$_0$, З$_1$, З$_2$, ..., З$_l$, ... задачи указанной последовательности, то $l$-ым сечением называется линейное ограничение, вводимое в задачу З$_{l-1}$ для образования задачи З$_l$, и удовлетворяющее двум условиям:
\begin{enumerate}
\item[a)] любое целочисленное решение системы ограничений задачи З$_{l-1}$ ему удовлетворяет;
\item[b)] найденное нецелочисленное решение задачи З$_{l-1}$ ему не удовлетворяет (“отсекается”).
\end{enumerate}
\parРассмотрим задачу целочисленного программирования, которая имеет следующий вид
\begin{equation}
\begin{split}
	&z = c_0 + (\vec c, \vec x) \rightarrow \textrm{max},\\
	&A\vec x = \vec b,\;\; \vec x \geq \vec 0,\\
	&x_j - \textit{целые} (j = 1,2,...,n),
\end{split}
\tag{$P_1$}
\end{equation}
то есть является задачей с ограничениями равенствами. Частным случаем такой задачи можно считать задачу вида
\begin{equation}
\begin{split}
	&z = \sum_{j=1}^n c_jx_j \rightarrow \textrm{max},\\
	&\sum_{j=1}^n a_{ij}x_j \leq b_i \;\;\; i = 1,2,...,m,\\
	&x_j \geq 0,\;\; x_j\;\textrm{- целые числа},\;\; j = 1,2,...,n,
\end{split}
\tag{$P_2$}
\end{equation}
\textit{в которой предполагается, что величины $b_i$ и $a_{ij}$ также являются целочисленными}. Задачу $(P2)$ легко свести к задаче вида $(P1)$ с помощью уравнивания неравенств. Задачу вида $(P1)$ (или ($P2$)) будем называть канонически целочисленной.
\parСуществует несколько методов построения сечений для целочисленных задач. В этом параграфе мы рассмотрим наиболее простой первый алгоритм Р. Гомори, который применяется к задаче вида $(P1)$, т.е. к канонически целочисленной задаче.
\parПусть задача З$_{l-1}$ уже решена симплекс методом и ее решение $\overline{X}_{l-1}$ не удовлетворяет условию целочисленности. Обозначим через ${a}$ дробную часть числа $a$, ${a}=a-[a]$, где $[a]$-целая часть числа $a$. Пусть $k$ — индекс свободных переменных в последней симплексной таблице. Обозначим через $s$ — номер строки в этой таблице с \textit{наибольшим} значением $\{b_s^*\}$ для свободного члена $b_s^*$, отвечающего базисной переменной. Тогда сечение Гомори запишется в виде
\begin{equation}
	\{b_s^*\} - \sum_k\{a_{sk}^*\}x_k \leq 0.
\tag{$S_1$}
\end{equation}
\parНе удовлетворяющее условию целочисленности  решение $\overline{X}_{l-1}$ задачи З$_{l-1}$ условию $(S1)$ не удовлетворяет. Действительно, в оптимальном опорном решении свободные переменные $x_k=0$, а поскольку $\{b_s^*\}$>0, то $(S1)$ на $\overline{X}_{l-1}$ не удовлетворяется. Следовательно, ограничение $(S1)$ удовлетворяет условию $b$), упомянутому выше. Покажем, что условие $(S1)$ удовлетворяет и условию $a$). Сначала мы установим, что оно удовлетворяется для любого целочисленного решения системы ограничений задачи $(P1)$. Рассмотрим $i$-ое ограничение этой задачи $\sum_{j=1}^n a_{ij}x_j = b_i$, и возьмем дробную часть от обеих частей равенства. Поскольку дробная часть суммы не превосходит суммы дробных частей слагаемых $(\{a+b\} \geq \{a\}+\{b\})$, то справедливо неравенство $\sum_{j=1}^n \{ a_{ij}\} x_j \geq \{ b_j \} $. Поскольку $x_j$ — целое неотрицательное число, то $ \{ a_{ij}x_j \} \leq \{ a_{ij} \} x_j $. Таким образом, для любого целочисленного решения выполнено неравенство $\sum_{j=1}^n \{ a_{ij} \} x_j \geq \{ b_i \} $. Это означает, что условие $a$) выполнено для сечения $(S1)$, построенного после решения задачи З$_0$, при построении задачи З$_1$. Для решения задачи З$_1$ симплекс методом неравенство, задающее сечение, нужно уровнять введением новой переменной. Можно показать, что эту новую переменную можно вывести из числа базисных переменных. В процессе решения задачи З$_1$ эта переменная в число базисных вернуться не может, так как она не входит в выражение для целевой функции. Поэтому мы можем рассматривать задачу З$_1$ в качестве задачи целочисленного программирования с увеличенным на единицу количеством переменных. В силу сказанного выше, построенное после решения задачи З$_1$ сечение будет обладать свойствами $a$), и $b$). То же можно сказать и о задаче З$_{l-1}$ при любом $l$.
\parАлгоритм решения канонически целочисленной задачи состоит из последовательности итераций, каждая из которых включает следующие пункты:
\begin{enumerate}
\item[1)] решается задача З$_{l-1}$ и находится ее оптимальное решение;
\item[2)] если решение этой задачи удовлетворяет условию целочисленности, то процесс заканчивается, и мы получаем оптимальный план. В противном случае переходим к пункту 3).
\item[3)] На основании последней симплекс-таблицы задачи З$_{l-1}$ записываем сечение Гомори $(S1)$.
\item[4)] Добавление ограничения из предыдущего пункта к условиям задачи З$_{l-1}$ приводит к задаче З$_l$, после чего снова возвращаемся к пункту 1) с увеличенным на единицу $l$.
\end{enumerate}
\parОтметим, что при некотором $l$ задача З$_l$ может оказаться не имеющей решения. Очевидно, что в случае недопустимости задачи З$_l$ и исходная задача целочисленного программирования тоже является недопустимой. Нетрудно показать, что если целевая функция задачи З$_l$ неограниченна на области допустимых решений, то это же справедливо и для исходной задачи целочисленного программирования.
\parМожно доказать, что в результате конечного числа итераций рассмотренного алгоритма мы придем к задаче З$_l$, которая либо имеет целочисленное решение, либо не имеет решений. В первом случае мы получаем решение исходной задачи целочисленного программирования, а во втором — устанавливаем, что эта задача не имеет решения.
\primer{
	Требуется найти оптимальный план задачи
	\begin{equation*}
	\begin{split}
		&z = x_1 + 4x_2 \rightarrow \textrm{max},\\
		&\begin{cases}
			-x_1 + 2x_2 \leq 2,\\
			3x_1 + 2x_2 \leq 6;
		\end{cases}\\
		&x_i \geq 0, \;\; x_i\; \textrm{- целые числа}(i = 1,2).
	\end{split}
	\end{equation*}
}
\parОтбрасывая условие целочисленности, решаем симплекс-методом задачу З$_0$:
\begin{equation*}
\begin{split}
	&z = x_1 + 4x_2 \rightarrow \textrm{max},\\
	&\begin{cases}
		-x_1 + 2x_2 + x_3 = 2,\\
		3x_1 + 2x_2 + x_4 = 6;
	\end{cases}\\
	&x_1 \geq 0, \;\; i = 1,2.
\end{split}
\end{equation*}
\begin{table}[h]
	\caption*{\hspace{0.8\linewidth} \textit{Таблица 1}}
	\centering%центрируем таблицу
		\begin{tabular}{|c|*{5}{c|}}
			\hline
			\parbox{2cm}{\centering Базисные переменные}& \parbox{2cm}{\centering Свободные члены} & \parbox{1.2cm}{\centering $x_1$} & \parbox{1.2cm}{\centering $\downarrow x_2$} & \parbox{1.2cm}{\centering $x_3$} & \parbox{1.2cm}{\centering $x_4$}\\
			\hline
			$\leftarrow x_3$ & 2 & -1 & \cellcolor[gray]{0.75}2 & 1 & 0\\
			\hline
			$x_4$ & 6 & 3 & 2 & 0 & 1 \\
			\hline
			z & 0 & -1 & -4 & 0 & 0 \\
			\hline
		\end{tabular}
\end{table}
